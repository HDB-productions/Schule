function Num(e) { if (this.n1 = [], this.n2 = [], this.point = "", this.positive = !0, this.print = function e() { document.write(this.toString()), document.write("<br>") }, this.trim = function e() { for (; this.n1.length > 1 && 0 == this.n1[0];)this.n1.shift(); return "" !== this.point && 0 == this.n2.length && (this.point = ""), this }, this.trim_front = function e() { for (; this.n1.length > 1 && 0 == this.n1[0];)this.n1.shift(); return this }, this.numberOfDecimals = function e() { return this.n2.length }, this.numberOfPreDecimals = function e() { return this.n1.length }, this.fill_decimals = function e(t) { for (var n = 0; n < t; n++)this.n2.push(0) }, this.fill_pre_decimals = function e(t) { for (var n = 0; n < t; n++)this.n1.unshift(0) }, this.same_number_of_decimals = function e(t) { this.numberOfDecimals() > t.numberOfDecimals() ? (t.fill_decimals(this.numberOfDecimals() - t.numberOfDecimals()), "" == t.point && (t.point = this.point)) : this.numberOfDecimals() < t.numberOfDecimals() && (this.fill_decimals(t.numberOfDecimals() - this.numberOfDecimals()), "" == this.point && (this.point = t.point)) }, this.same_number_of_pre_decimals = function e(t) { this.numberOfPreDecimals() > t.numberOfPreDecimals() ? (t.fill_pre_decimals(this.numberOfPreDecimals() - t.numberOfPreDecimals()), "" == t.point && (t.point = this.point)) : this.numberOfPreDecimals() < t.numberOfPreDecimals() && (this.fill_pre_decimals(t.numberOfPreDecimals() - this.numberOfPreDecimals()), "" == this.point && (this.point = t.point)) }, this.same_comma = function e(t) { "" !== this.point && "" !== t.point && this.point !== t.point && (t.point = this.point) }, this.clear = function e() { this.n1 = [], this.n2 = [], this.point = "" }, this.setComma = function e(t) { this.point = t }, this.push_front_n1 = function e(t) { this.n1.unshift(t) }, this.push_front_n2 = function e(t) { this.n2.unshift(t) }, this.push_back_n1 = function e(t) { this.n1.push(t) }, this.push_back_n2 = function e(t) { this.n2.push(t) }, this.smaller = function e(t) { if (this.trim(), t.trim(), this.numberOfPreDecimals() > t.numberOfPreDecimals()) return 0; if (t.numberOfPreDecimals() > this.numberOfPreDecimals()) return 1; for (var n = 0; n < this.numberOfPreDecimals(); n++) { if (this.n1[n] < t.n1[n]) return 1; if (t.n1[n] < this.n1[n]) return 0 } for (var n = 0; n < this.numberOfDecimals(); n++) { if (n >= t.numberOfDecimals()) return 0; if (this.n2[n] < t.n2[n]) return 1; if (t.n2[n] < this.n2[n]) return 0 } return this.numberOfDecimals() < t.numberOfDecimals() ? 1 : 0 }, this.move_decimal_point_right = function e(t) { for (; t > 0;)this.n2.length > 0 ? (this.n1.push(this.n2.shift()), 0 == this.n2.length && this.point) : this.n1.push(0), t--; this.trim() }, this.toString = function e() { var t = ""; !1 == this.positive && (t = "-"); for (var n = 0; n < this.n1.length; n++)t += this.n1[n].toString(); if ("." == this.point || "," == this.point) { t += this.point; for (var n = 0; n < this.n2.length; n++)t += this.n2[n].toString() } return t }, this.copy = function e() { return new Num(this.toString()) }, this.is_zero = function e() { for (var t = 0; t < this.n1.length; t++)if (0 != this.n1[t]) return !1; for (var t = 0; t < this.n2.length; t++)if (0 != this.n2[t]) return !1; return !0 }, 0 == e.length) throw "empty"; if ("-" == e[0]) throw "negative"; if ("," == e[0] || "." == e[0]) throw "not a number"; for (var t = 0; t < e.length; t++)if ("." == e[t] || "," == e[t]) { if ("" == this.point) this.point = e[t]; else throw "not a number" } else if (Number.isInteger(parseInt(e[t]))) "" == this.point ? this.n1.push(parseInt(e[t])) : this.n2.push(parseInt(e[t])); else throw "not a number"; if (this.trim(), void 0 !== withRest && withRest && 0 != this.n2.length) throw "decimal" } function add(e, t) { e.same_number_of_decimals(t), e.same_number_of_pre_decimals(t), e.same_comma(t); var n, i = new Num("0"), s = new Num("0"), r = 0; i.clear(), s.clear(); for (var a = e.n2.length - 1; a >= 0; a--)n = e.n2[a] + t.n2[a] + r, i.push_front_n2(n % 10), r = Math.floor(n / 10), s.push_front_n2(Math.floor(n / 10)); i.n2.length > 0 && (i.setComma(e.point), s.setComma(e.point)); for (var a = e.n1.length - 1; a >= 0; a--)n = e.n1[a] + t.n1[a] + r, i.push_front_n1(n % 10), r = Math.floor(n / 10), s.push_front_n1(Math.floor(n / 10)); return 0 != r && i.push_front_n1(r), [i, s] } function multiply(e, t) { e.trim(), t.trim(), e.same_comma(t); var n, i, s = [], r = [], a = 0, l = e.n2.length + t.n2.length, o = ","; ("." == e.point || "." == t.point) && (o = "."); for (var h = 0; h < t.n1.length; h++) { s[h] = []; for (var d = e.n2.length - 1; d >= 0; d--)a = Math.floor((n = e.n2[d] * t.n1[h] + a) / 10), s[h].unshift(n % 10); for (var d = e.n1.length - 1; d >= 0; d--)a = Math.floor((n = e.n1[d] * t.n1[h] + a) / 10), s[h].unshift(n % 10); for (; a > 0;)s[h].unshift(a % 10), a = Math.floor(a / 10); r.push(copy_array(s[h])); for (var d = t.n1.length + t.n2.length - h - 1; d > 0; d--)s[h].push(0); for (var d = s[h].length; d < s[0].length; d++)s[h].unshift(0) } for (var h = 0; h < t.n2.length; h++) { s[h + t.n1.length] = []; for (var d = e.n2.length - 1; d >= 0; d--)a = Math.floor((n = e.n2[d] * t.n2[h] + a) / 10), s[h + t.n1.length].unshift(n % 10); for (var d = e.n1.length - 1; d >= 0; d--)a = Math.floor((n = e.n1[d] * t.n2[h] + a) / 10), s[h + t.n1.length].unshift(n % 10); for (; a > 0;)s[h + t.n1.length].unshift(a % 10), a = Math.floor(a / 10); r.push(copy_array(s[h + t.n1.length])); for (var d = t.n2.length - h - 1; d > 0; d--)s[h + t.n1.length].push(0); for (var d = s[h + t.n1.length].length; d < s[0].length; d++)s[h + t.n1.length].unshift(0) } a = 0; var c = new Num("0"); c.clear(); var m = new Num("0"); m.clear(); for (var h = s[0].length - 1; h >= 0; h--) { n = 0, i = 0; for (var d = 0; d < s.length; d++)i += s[d][h]; n = i + a, c.push_front_n1(n % 10), a = Math.floor(n / 10), m.push_front_n1(Math.floor(n / 10)) } if (a > 0) for (; a > 0;)c.push_front_n1(a % 10), a = Math.floor(a / 10); if (l > 0) { c.point = o; for (var h = 0; h < l; h++)c.push_front_n2(c.n1.pop()) } return [c, r, m] } function copy_array(e) { for (var t = [], n = 0; n < e.length; n++)t.push(e[n]); return t } function Canvas(e, t, n, i, s) { this.boxes_x = e, this.boxes_y = t, this.box_size = n, this.drawBoxes = function e() { for (var t = 0; t <= this.boxes_x; t++)this.drawLineSVG(t * this.box_size, 0, t * this.box_size, this.boxes_y * this.box_size, "#d3d3d3"); for (var t = 0; t <= this.boxes_y; t++)this.drawLineSVG(0, t * this.box_size, this.boxes_x * this.box_size, t * this.box_size, "#d3d3d3") }, this.drawDigit = function e(t, n, i, s = !1) { var r = document.createElementNS(svgns, "text"); r.setAttribute("x", n * this.box_size + this.box_size / 2 + 1), r.setAttribute("y", i * this.box_size + this.box_size / 2 + 1), r.textContent = t, r.setAttribute("text-anchor", "middle"), r.setAttribute("dominant-baseline", "central"), r.setAttribute("font-family", "Arial, Helvetica, sans-serif"), r.setAttribute("font-size", .9 * this.box_size + "px"), r.style.pointerEvents = "none", s && r.setAttribute("fill", "#888888"), svg.appendChild(r) }, this.drawNumber = function e(t, n, i, s = !1) { for (var r = [], a = 0; a < t.n1.length; a++)this.drawDigit(t.n1[t.n1.length - a - 1], n - a, i), r.unshift([t.n1[t.n1.length - a - 1], n - a, i]); if ("" !== t.point) { r.unshift(this.drawPoint(t.point, n, i, s)); for (var a = 0; a < t.n2.length; a++)this.drawDigit(t.n2[a], n + a + 1, i), r.push([t.n2[a], n + a + 1, i]) } return r }, this.drawLine = function e(t, i, s, a) { var l = t * this.box_size, o = i * this.box_size + this.box_size; a && (o += r), this.drawLineSVG(l, o, l + s * n, o, "#000000") }, this.drawCarryover = function e(t, n, i) { for (var s = 0; s < t.n1.length; s++)t.n1[t.n1.length - s - 1] > 0 && this.drawDigitSVG(t.n1[t.n1.length - s - 1], n - s, i, !0); if (t.n2.length > 0) for (var s = 0; s < t.n2.length; s++)t.n2[s] > 0 && this.drawDigitSVG(t.n2[s], n + s + 1, i, !0) }, this.drawNumberArray = function e(t, n, i, s) { for (var r = [], a = 0; a < t.length; a++)this.drawDigit(t[t.length - a - 1], n + i - a, s), r.unshift([t[t.length - a - 1], n + i - a, s]); return r }, this.drawPeriod = function e(t, i, s) { var a = t * this.box_size, l = i * this.box_size + this.box_size; return this.drawLineSVG(a, l - n, a + s * n + r, l - n, "#000000", !0), [a, l - n, a + s * n + r, l - n] }, this.drawRest = function e(t, n, i) { return this.drawDigit("R", n, i), this.drawNumber(t, n + t.n1.length, i) }, this.drawPoint = function e(t, i, s, r = !1) { var a = document.createElementNS(svgns, "text"); return a.setAttribute("x", (i + 1) * this.box_size), a.setAttribute("y", s * this.box_size + .5 * n), a.textContent = t, a.setAttribute("text-anchor", "middle"), a.setAttribute("dominant-baseline", "central"), a.setAttribute("font-family", "Arial, Helvetica, sans-serif"), a.setAttribute("font-size", 1.5 * this.box_size + "px"), a.style.pointerEvents = "none", svg.appendChild(a), r && (this.solCommaElement = a), [t, (i + 1) * this.box_size, (s + 1) * this.box_size] }, this.coordinates_to_position = function e(t, i) { var s, r = svg.getBoundingClientRect(), a = t - r.left; return [Math.floor(a / n), Math.floor((i - r.top) / n)] }, this.mark_box = function e(t, i) { var s = document.createElementNS(svgns, "rect"); s.setAttribute("x", t * n + 1), s.setAttribute("y", i * n + 1), s.setAttribute("width", n - 2), s.setAttribute("height", n - 2), this.markers.appendChild(s) }, this.mark_period = function e(t) { t ? this.period.setAttribute("style", "stroke:#0000FF;+stroke-width:1") : this.period.setAttribute("style", "stroke:#000000;+stroke-width:1") }, this.mark_comma = function e(t) { this.solCommaElement && (t ? this.solCommaElement.setAttribute("fill", "#0000FF") : this.solCommaElement.setAttribute("fill", "#000000")) }, this.determineIfFlexbox = function e() { this.boxes_x * this.box_size > window.innerWidth - 40 ? document.getElementById("svg-container").classList.remove("center") : document.getElementById("svg-container").classList.add("center") }, this.drawRectSVG = function e(t, n, i, s, r) { var a = document.createElementNS(svgns, "rect"); a.setAttribute("x", t), a.setAttribute("y", n), a.setAttribute("width", i), a.setAttribute("height", s), a.setAttribute("fill", r), svg.appendChild(a) }, this.drawDigitSVG = function e(t, n, i, s = !1) { var r = document.createElementNS(svgns, "text"); r.setAttribute("x", n * this.box_size + this.box_size / 2 + 1), r.setAttribute("y", i * this.box_size + this.box_size / 2 + 1), r.textContent = t, r.setAttribute("text-anchor", "middle"), r.setAttribute("dominant-baseline", "central"), r.setAttribute("font-family", "Arial, Helvetica, sans-serif"), r.setAttribute("font-size", .9 * this.box_size + "px"), r.style.pointerEvents = "none", s && r.setAttribute("fill", "#888888"), svg.appendChild(r) }, this.drawLineSVG = function e(t, n, i, s, r, a = !1) { var l = document.createElementNS(svgns, "line"); l.setAttribute("x1", t), l.setAttribute("x2", i), l.setAttribute("y1", n), l.setAttribute("y2", s), l.setAttribute("style", "stroke:" + r + ";+stroke-width:1"), a && (this.period = l), svg.appendChild(l) }, this.demark_boxes = function e() { for (; this.markers.hasChildNodes();)this.markers.firstChild.remove() }, this.solCommaElement = void 0, this.period = void 0, this.svg = svg, window.addEventListener ? (svg.addEventListener("mousemove", i, !1, { passive: !0 }), svg.addEventListener("mouseleave", s, !1, { passive: !0 })) : window.attachEvent && (svg.attachEvent("mousemove", i), svg.attachEvent("mouseleave", s)); let r = this.box_size / 2; for ((.9 * this.box_size).toString(), svg.setAttribute("width", e * n), svg.setAttribute("height", t * n), this.drawRectSVG(0, 0, e * n, t * n, "white"), this.markers = document.createElementNS(svgns, "g"), this.markers.setAttribute("fill", "#B6DCFC"), svg.appendChild(this.markers); document.getElementById("svg-container").hasChildNodes();)document.getElementById("svg-container").firstChild.remove(); document.getElementById("svg-container").appendChild(svg), this.drawBoxes() } let markedInputs = []; class CanvasSelf { constructor(e, t, n, i) { this.boxes_x = e, this.boxes_y = t, this.table = document.createElement("table"), this.table.id = "exercise", this.table.classList.add("not-selectable"), this.carryoverElements = [], this.solutionElements = [], this.period = void 0; for (var s, r, a, l = 0; l < t; l++) { s = document.createElement("tr"); for (var o = 0; o < e; o++)r = document.createElement("td"), s.appendChild(r); this.table.appendChild(s) } exerciseContainer.appendChild(this.table) } insertEntry(e, t, n) { this.table.childNodes[n].childNodes[t].appendChild(e) } insertNumber(e, t, n) { for (var i = 0; i < e.n1.length; i++)this.insertEntry(new Digit(e.n1[e.n1.length - i - 1], "normal-character").element, t - i, n); if ("" !== e.point) { for (var i = 0; i < e.n2.length; i++)this.insertEntry(new Digit(e.n2[i], "normal-character").element, t + i + 1, n); this.insertPoint(e.point, t, n) } } insertCarryoverRow(e, t, n) { for (var i, s = 0; s < e.n1.length; s++)i = new InputCarryover(e.n1[e.n1.length - s - 1]), this.insertEntry(i.element, t - s - 1, n), this.carryoverElements.push(i); for (var s = 0; s < e.n2.length; s++)i = new InputCarryover(e.n2[s]), this.insertEntry(i.element, t + s, n), this.carryoverElements.push(i) } drawLine(e, t, n) { for (var i = e; i <= t; i++)this.table.childNodes[n].childNodes[i].classList.add("line-top") } insertSolutionRow(e, t, n, i = !1, s = !1) { var r; let a; s && (a = [this.table.firstChild.childNodes[i].firstChild]); for (var l = 0; l < e.n1.length; l++)r = new InputSolution(e.n1[e.n1.length - l - 1]), this.insertEntry(r.element, t - l, n), this.solutionElements.push(r), s && a.push(r.element), i && !s && (r.element.addEventListener("focusin", e => { this.table.firstChild.childNodes[i].classList.add("mark") }, { passive: !0 }), r.element.addEventListener("focusout", e => { this.table.firstChild.childNodes[i].classList.remove("mark") }, { passive: !0 })); if ("" !== e.point) { for (var l = 0; l < e.n2.length; l++)r = new InputSolution(e.n2[l]), this.insertEntry(r.element, t + l + 1, n), this.solutionElements.push(r), i && (r.element.addEventListener("focusin", e => { this.table.firstChild.childNodes[i].classList.add("mark") }, { passive: !0 }), r.element.addEventListener("focusout", e => { this.table.firstChild.childNodes[i].classList.remove("mark") }, { passive: !0 })); this.insertPoint(e.point, t, n) } if (s) for (var l = 0; l < a.length; l++)a[l].addEventListener("focusin", e => { for (var t = 0; t < a.length; t++)a[t].classList.add("mark") }, { passive: !0 }), a[l].addEventListener("focusout", e => { for (var t = 0; t < a.length; t++)a[t].classList.remove("mark") }, { passive: !0 }) } insertPoint(e, t, n) { var i = this.table.childNodes[n].childNodes[t], s = new Point(e, 0, 0); i.appendChild(s.element), i.classList.add("relative") } determineIfFlexbox() { this.table.getBoundingClientRect().width > window.innerWidth - 100 ? document.getElementById("exercise-container").classList.remove("center") : document.getElementById("exercise-container").classList.add("center") } checkInputs() { for (var e = !0, t = 0; t < this.carryoverElements.length && e; t++)this.carryoverElements[t].inputCorrect() || (e = !1); if (!e) return !1; for (var n = !0, t = 0; t < this.solutionElements.length && n; t++)this.solutionElements[t].inputCorrect() || (n = !1); return n } showSolution() { for (var e = 0; e < this.carryoverElements.length; e++)this.carryoverElements[e].showDigit(); for (var e = 0; e < this.solutionElements.length; e++)this.solutionElements[e].showDigit(); "undefined" == typeof expectedInputPeriod || (this.period ? this.period.checkInput() || this.period.changeStart(expectedInputPeriod, "wrong") : this.drawPeriod(expectedInputPeriod, "wrong")) } markWrongInputs() { for (var e = 0; e < this.carryoverElements.length; e++)this.carryoverElements[e].markIfWrong(); for (var e = 0; e < this.solutionElements.length; e++)this.solutionElements[e].markIfWrong(); "undefined" != typeof expectedInputPeriod && this.period && !this.period.checkInput() && this.period.changeState("wrong") } manageCarryoverInputMaxLength() { for (var e = 1, t = 0; t < this.carryoverElements.length; t++)e = Math.max(e, this.carryoverElements[t].expectedDigit.toString().length); if (e > 1) for (var t = 0; t < this.carryoverElements.length; t++)this.carryoverElements[t].element.maxLength = e.toString() } disableAllInputfields() { for (var e of this.solutionElements) e.element.disabled = !0, e.element.classList.add("disabled") } enableAllInputfields() { for (var e of this.solutionElements) e.element.disabled = !1, e.element.classList.remove("disabled") } drawPeriod(e, t) { this.periodField && (this.periodField.classList.remove("relative-period"), this.periodField.lastChild.remove(), this.periodField = void 0); var n = document.createElement("div"); n.id = "period"; var i = this.table.firstChild.firstChild.getBoundingClientRect(), s = this.table.firstChild.lastChild.getBoundingClientRect(); n.style.width = s.right - i.left + s.width / 2, this.period ? this.period.changeStart(e, t) : this.period = new Period(e, this.table.firstChild.lastChild, t) } } class TableEntry { constructor() { } } class Digit extends TableEntry { constructor(e, t, n = !0) { super(), this.element = document.createElement("span"), 0 == e.length && (e = " "), this.element.appendChild(document.createTextNode(e)), n ? this.element.classList.add("correct") : "normal-character" != t && this.element.classList.add("incorrect"), this.element.classList.add(t) } } class InputEntry extends TableEntry { constructor(e, t = !1) { super(), this.element = document.createElement("input"), this.element.classList.add("input-number"), this.element.maxLength = 1, this.expectedDigit = e, this.notImportant = t, this.element.addEventListener("input", e => inputListener(this.element), { passive: !0 }) } inputCorrect() { return this.element.value === this.expectedDigit.toString() } showDigit(e, t) { var n = t || this.expectedDigit.toString() === this.element.value, i = new Digit(this.expectedDigit, e, n); this.element.parentElement.replaceChild(i.element, this.element) } } class InputCarryover extends InputEntry { constructor(e) { var t; super("0" == e ? "" : e), this.element.classList.add("input-carryover") } inputCorrect() { return super.inputCorrect() || "" === this.expectedDigit && "0" === this.element.value } showDigit() { this.inputCorrect() ? super.showDigit("carryover", !0) : super.showDigit("carryover", !1) } markIfWrong() { this.inputCorrect() || (this.element.classList.add("wrong"), markedInputs.push(this)) } } class InputSolution extends InputEntry { constructor(e, t = !1) { super(e, t), this.element.classList.add("input-solution"), this.notImportant = t } inputCorrect() { return super.inputCorrect() || this.notImportant && "0" === this.element.value } showDigit() { this.inputCorrect() ? super.showDigit("solution", !0) : super.showDigit("solution", !1) } markIfWrong() { this.inputCorrect() || (this.element.classList.add("wrong"), markedInputs.push(this)) } } class Point { constructor(e, t, n) { this.element = document.createElement("span"), this.element.appendChild(document.createTextNode(e)), this.element.classList.add("point") } } class Period { constructor(e, t, n) { this.startInputField = e, this.endInputField = t, this.state = n, this.startInputField.classList.add("relative-period"), this.period_div = document.createElement("div"), this.period_div.id = "period", this.period_div.classList.add(this.state); var i = this.startInputField.getBoundingClientRect(), s = this.endInputField.getBoundingClientRect(); this.period_div.style.width = Math.floor(s.right - i.left + s.width / 2) + "px", this.startInputField.appendChild(this.period_div) } changeStart(e, t) { this.startInputField.classList.remove("relative-period"), this.startInputField = e, this.startInputField.classList.add("relative-period"), this.changeState(t); var n = this.startInputField.getBoundingClientRect(), i = this.endInputField.getBoundingClientRect(); this.period_div.style.width = Math.floor(i.right - n.left + i.width / 2) + "px", this.startInputField.appendChild(this.period_div) } changeState(e) { this.state != e && (this.period_div.classList.remove(this.state), this.state = e, this.period_div.classList.add(this.state)) } removePeriod() { this.startInputField.classList.remove("relative-period"), this.startInputField.lastChild.remove(), canvas.period = void 0 } resize() { var e = this.startInputField.getBoundingClientRect(), t = this.endInputField.getBoundingClientRect(); this.period_div.style.width = Math.floor(t.right - e.left + t.width / 2) + "px" } checkInput() { return this.startInputField == expectedInputPeriod } show() { this.checkInput() } markIfWrong() { } } function inputListener(e) { /^[0-9]+$/.test(e.value) || (e.value = ""), demarkMarked() } function demarkMarked() { for (; markedInputs.length > 0;)markedInputs.shift().element.classList.remove("wrong"); messageContainer.classList.remove("show"), canvas.period && "wrong" == canvas.period.state && canvas.period.changeState("normal") } let comma, mouse_on_comma, comma_array, current_x, current_y, number_array; function mult(e, t) { comma = -1, mouse_on_comma = !1, current_x = -1, current_y = -1; var n, i = multiply(e, t), s = i[0], r = i[1], a = i[2], l = e.n1.length + e.n2.length + t.n1.length + t.n2.length + 5, o = r.length + 7, h = new Canvas(l, o, 25, mouse_moved, mouse_leave); number_array = []; for (var d = 0; d < l; d++)number_array[d] = []; var c = h.drawNumber(e, e.n1.length + 1, 2); h.drawDigit("*", e.n1.length + e.n2.length + 2, 2); var m = h.drawNumber(t, e.n1.length + e.n2.length + 2 + t.n1.length, 2); h.drawLine(2, 2, e.n1.length + e.n2.length + 1 + t.n1.length + t.n2.length); var u = Math.floor((l - (r[0].length + r.length - 1)) / 2) + r[0].length; ("." == c[0][0] || "," == c[0][0]) && c.shift(), ("." == m[0][0] || "," == m[0][0]) && m.shift(); for (var d = 0; d < r.length; d++) { var g = (n = h.drawNumberArray(r[d], d, u, d + 3)).concat(c); g.push(m[d]); for (var v = 0; v < n.length; v++)number_array[n[v][1]][n[v][2]] = [n[v][0], g]; number_array[m[d][1]][m[d][2]] = [m[d][0], g] } h.drawCarryover(a, u + r.length - 2, r.length + 3), h.drawLine(2, r.length + 3, e.n1.length + e.n2.length + 1 + t.n1.length + t.n2.length); var p = h.drawNumber(s, u + r.length - s.n2.length - 1, r.length + 4, !0); if ("." == p[0][0] || "," == p[0][0]) { comma = p[0], comma_array = []; for (var d = 0; d < e.n2.length; d++)comma_array.push(c[c.length - 1 - d]); for (var d = 0; d < t.n2.length; d++)comma_array.push(m[m.length - 1 - d]); for (var d = 0; d < s.n2.length; d++)comma_array.push(p[p.length - 1 - d]) } return h.determineIfFlexbox(), h } function mouse_moved(e) { try { if (-1 != comma && mouse_over_comma(e)) { if (mouse_on_comma) return; canvas.mark_comma(!0); for (var t = 0; t < comma_array.length; t++)canvas.mark_box(comma_array[t][1], comma_array[t][2]); mouse_on_comma = !0; return } mouse_on_comma && (mouse_on_comma = !1, canvas.mark_comma(!1), canvas.demark_boxes()); var n = canvas.coordinates_to_position(e.clientX, e.clientY), i = n[0], s = n[1]; if (current_x == i && current_y == s) return; if (current_x >= 0 && current_y >= 0 && void 0 != number_array[current_x][current_y] && canvas.demark_boxes(), void 0 != number_array[i][s]) for (var t = 0; t < number_array[i][s].length; t++)for (var r = 0; r < number_array[i][s][t].length; r++)canvas.mark_box(number_array[i][s][t][r][1], number_array[i][s][t][r][2]); current_x = i, current_y = s } catch (a) { window.alert(a) } } function mouse_leave(e) { current_x >= 0 && current_y >= 0 && canvas.demark_boxes(), current_x = -1, current_y = -1 } function mult_self(e, t) { comma = -1, mouse_on_comma = !1, current_x = -1, current_y = -1; var n = multiply(e, t), i = n[0], s = n[1], r = n[2], a = e.n1.length + e.n2.length + t.n1.length + t.n2.length + 1, l = s.length + 3, o = new CanvasSelf(a, l, 21); number_array = []; for (var h = 0; h < a; h++)number_array[h] = []; o.insertNumber(e, e.n1.length - 1, 0), o.insertEntry(new Digit("*", "normal-character").element, e.n1.length + e.n2.length, 0), o.insertNumber(t, e.n1.length + e.n2.length + t.n1.length, 0), o.drawLine(0, e.n1.length + e.n2.length + 1 + t.n1.length + t.n2.length - 1, 1); let d = e.n1.length + e.n2.length + 1; for (var h = 0; h < s.length; h++) { for (var c = "", m = 0; m < s[h].length; m++)c += s[h][m]; c = new Num(c), o.insertSolutionRow(c, a - 1 - (s.length - h - 1), h + 1, d + h) } return o.drawLine(0, e.n1.length + e.n2.length + 1 + t.n1.length + t.n2.length - 1, s.length + 2), o.insertCarryoverRow(r, a - 1, s.length + 1), o.insertSolutionRow(i, a - 1 - i.n2.length, s.length + 2), o.manageCarryoverInputMaxLength(), o.determineIfFlexbox(), o } function mouse_over_comma(e) { var t = svg.getBoundingClientRect(), n = e.clientX - t.left, i = e.clientY - t.top; return n >= comma[1] - 5 && n <= comma[1] + 5 && i >= comma[2] - 5 && i <= comma[2] + 5 } function calculate(e, t) { resetCanvas(), window.removeEventListener("resize", resizeHandler); var n, i, s = void 0; try { n = new Num(input_number1.value.trim()) } catch (r) { var a = "keine g\xfcltige Zahl"; switch (r) { case "empty": a = "Das Feld darf nicht leer sein."; break; case "negative": a = "Die Zahl muss positiv sein."; break; case "decimal": a = "Die Zahl muss eine ganze Zahl sein." }return svg.style.display = "none", reportValidity(input_number1, a) } try { i = new Num(input_number2.value.trim()) } catch (l) { var a = "keine g\xfcltige Zahl"; switch (l) { case "empty": a = "Das Feld darf nicht leer sein."; break; case "negative": a = "Die Zahl muss positiv sein."; break; case "decimal": a = "Die Zahl muss eine ganze Zahl sein." }return svg.style.display = "none", reportValidity(input_number2, a) } if (document.getElementById("decimals")) { if (!(s = document.getElementById("decimals").value.trim()).match(/^(0|[1-9][0-9]*)$/) && 0 != s.length) return svg.style.display = "none", reportValidity(decimalsInput, "Keine g\xfcltige Zahl."); var o = !1; (1 != i.n1.length || 0 != i.n1[0]) && (o = !0); for (var h = 0; h < i.n2.length && !o; h++)0 != i.n2[h] && (o = !0); if (!o) return svg.style.display = "none", reportValidity(decimalsInput, "Teilen durch 0 ist nicht m\xf6glich.") } if (void 0 != (canvas = void 0 == s ? e(n, i) : e(n, i, s))) { window.addEventListener("resize", resizeHandler, { passive: !0 }), saveCalculationAccordion.classList.remove("hide"), document.getElementById("url-text").innerHTML = ""; var d = "https://schriftlich-rechnen.de/" + t + "/?z1=" + input_number1.value.trim() + "&z2=" + input_number2.value.trim(); s && document.getElementById("decimals").value > 0 && !withRest && (d += "&komma=" + document.getElementById("decimals").value), withRest && (d += "&rest=" + (document.getElementById("rest-select").checked ? "true" : "false")), document.getElementById("calculate-yourself-button") && document.getElementById("calculate-yourself-button").classList.contains("checked") ? (d += "&selber=true", document.getElementById("save-calculation-summary").nodeValue = "URL anzeigen", document.getElementById("headline-download-image").classList.add("hide"), document.getElementById("download-image").classList.add("hide")) : (document.getElementById("save-calculation-summary").nodeValue = "Berechnung speichern", document.getElementById("headline-download-image").classList.remove("hide"), document.getElementById("download-image").classList.remove("hide")), document.getElementById("url-text").appendChild(document.createTextNode(d)), calcYourselfCheckbox.checked && document.getElementById("exercise-buttons-div") && document.getElementById("exercise-buttons-div").classList.remove("hide"), document.body.classList.add("calculation-shown") } } function reportValidity(e, t) { return e.setCustomValidity(t), e.reportValidity(), !1 } function loadParameters() { if ("" != window.location.search) { var e = new URLSearchParams(window.location.search); e.get("selber") && "true" == e.get("selber") && document.getElementById("calculate-yourself-button") && document.getElementById("calculate-yourself-button").click(); var t = e.get("z1") ? e.get("z1") : "", n = e.get("z2") ? e.get("z2") : "", i = e.get("komma") ? e.get("komma") : "", s = e.get("rest") ? e.get("rest") : ""; t.length > 0 && (document.getElementById("number1").value = t), n.length > 0 && (document.getElementById("number2").value = n), document.getElementById("decimals") && (document.getElementById("decimals").value = ""), i.length > 0 && document.getElementById("decimals") && (document.getElementById("decimals").value = "leer" != i ? i : ""), s.length > 0 && document.getElementById("rest-select") && ("true" == s ? document.getElementById("rest-select").click() : "false" == s && document.getElementById("comma-select").click()), t.length > 0 && n.length > 0 && document.getElementById("submit-button").click() } } function copyURLToClipboard() { navigator.clipboard.writeText(document.getElementById("url-text").firstChild.nodeValue) } function downloadImage(e) { var t, n = document.getElementById("data-format").value, i = document.getElementById("input-filename").value; (i = i.trim()).length > 200 && (i = i.substring(0, 200)), (i = i.replace(/[^a-z0-9 .]/gi, "_")).length >= n.length + 1 && i.substring(i.length - (n.length + 1), i.length).toLowerCase() == "." + n && (i = i.substring(0, i.length - (n.length + 1))), "" == i && (i = e); var s = new XMLSerializer().serializeToString(svg); if (s = '<?xml version="1.0" standalone="no"?>\r\n' + s, "svg" == n) { t = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(s); var r = document.createElement("a"); r.href = t, r.download = i, r.click() } else { var a = new Blob([s], { type: "image/svg+xml;charset=utf-8" }); urlSVG = window.URL.createObjectURL(a); var l = new Image; l.src = urlSVG, l.onload = function () { var e = document.createElement("canvas"); e.width = svg.width.baseVal.value, e.height = svg.height.baseVal.value, e.getContext("2d").drawImage(l, 0, 0), t = e.toDataURL("image/" + n); var s = document.createElement("a"); s.href = t, s.download = i, s.click() } } } function changeRestComma() { var e = document.getElementById("rest-select").checked; e ? document.getElementById("select-rest-comma").classList.add("checked") : document.getElementById("select-rest-comma").classList.remove("checked"), withRest != e && (withRest = e, resetCanvas(), e ? document.getElementById("decimals-input-div").classList.add("hide") : document.getElementById("decimals-input-div").classList.remove("hide")) } function calculateYourselfChanged() { function e(e, t) { var n = document.getElementById(e); n && (t ? svgContainer.hasChildNodes() ? n.classList.add("hidden") : n.classList.remove("hidden") : svgContainer.hasChildNodes() ? n.classList.remove("hidden") : n.classList.add("hidden")) } var t = calcYourselfCheckbox.checked; e("cut_decimals", t), e("shift_comma", t), e("period-buttons-container", t), t ? (svgContainer.classList.add("hide"), exerciseContainer.classList.remove("hide"), document.getElementById("calculate-yourself-button").classList.add("checked"), exerciseContainer.hasChildNodes() ? document.getElementById("exercise-buttons-div").classList.remove("hide") : document.getElementById("exercise-buttons-div").classList.add("hide"), document.getElementById("message").classList.remove("hide"), document.getElementById("switch_numbers") && document.getElementById("switch_numbers").parentNode.classList.add("hidden"), document.getElementById("solution") && document.getElementById("solution").parentNode.classList.add("hidden")) : (svgContainer.classList.remove("hide"), exerciseContainer.classList.add("hide"), document.getElementById("calculate-yourself-button").classList.remove("checked"), document.getElementById("exercise-buttons-div").classList.add("hide"), document.getElementById("message").classList.add("hide"), document.getElementById("switch_numbers") && document.getElementById("switch_numbers").parentNode.classList.remove("hidden"), document.getElementById("solution") && document.getElementById("solution").parentNode.classList.remove("hidden")) } function resetCanvas() { function e(e) { var t = document.getElementById(e); t && (t.classList.add("hide"), t.classList.remove("hidden")) } for (canvas = void 0, saveCalculationAccordion.classList.add("hide"), input_number1.parentNode.classList.remove("showError"), input_number2.parentNode.classList.remove("showError"), document.getElementById("decimals") && decimalsInput.parentNode.classList.remove("showError"), document.getElementById("message") && messageContainer.classList.remove("show"), e("shift_comma"), e("cut_decimals"), e("period-buttons-container"), document.getElementById("switch_numbers") && document.getElementById("switch_numbers").classList.add("hide"), document.getElementById("solution") && document.getElementById("solution").classList.add("hide"), document.getElementById("exercise-buttons-div") && document.getElementById("exercise-buttons-div").classList.add("hide"), document.getElementById("period-buttons-container") && (document.getElementById("delete-period-button").classList.add("hide"), document.getElementById("add-period-text").classList.remove("hide"), document.getElementById("change-period-text").classList.add("hide")), svgContainer.hasChildNodes() && svgContainer.removeChild(svgContainer.firstChild), (svg = document.createElementNS("http://www.w3.org/2000/svg", "svg")).id = "canvas"; exerciseContainer.hasChildNodes();)exerciseContainer.removeChild(exerciseContainer.firstChild); document.body.classList.remove("calculation-shown") } function checkInputs() { var e = canvas.checkInputs(); for (e && "undefined" != typeof expectedInputPeriod && (e = canvas.period && canvas.period.checkInput()), message.hasChildNodes() || message.appendChild(document.createTextNode("")), e ? (showSolution(), message.firstChild.nodeValue = "Alle Eingaben sind richtig.", message.classList.remove("negative"), message.classList.add("positive"), document.getElementById("period-buttons-container") && document.getElementById("period-buttons-container").classList.add("hide"), canvas.period && canvas.period.resize()) : (message.firstChild.nodeValue = "Es stimmen noch nicht alle Eingaben.", message.classList.add("negative"), message.classList.remove("positive")), messageContainer.classList.add("show"); markedInputs.length > 0;)markedInputs.shift().element.classList.remove("wrong"); canvas.period && "wrong" == canvas.period.state && canvas.period.changeState("normal") } function showSolution() { var e = canvas.checkInputs(); for (e && "undefined" != typeof expectedInputPeriod && (e = canvas.period && canvas.period.checkInput()), canvas.showSolution(), document.getElementById("exercise-buttons-div").classList.add("hide"), e ? (message.hasChildNodes() || message.appendChild(document.createTextNode("")), message.firstChild.nodeValue = "Alle Eingaben sind richtig.", message.classList.remove("negative"), message.classList.add("positive"), messageContainer.classList.add("show")) : messageContainer.classList.remove("show"); markedInputs.length > 0;)markedInputs.shift().element.classList.remove("wrong"); canvas.period && canvas.period.resize(), document.getElementById("period-buttons-container") && document.getElementById("period-buttons-container").classList.add("hide") } function markWrongInputs() { for (; markedInputs.length > 0;)markedInputs.shift().element.classList.remove("wrong"); canvas.markWrongInputs(), messageContainer.classList.remove("show") } function resizeHandler() { void 0 != canvas && canvas.determineIfFlexbox() } let imageNamesMap = new Map; function removeLazyLoading(e) { let t = imageNamesMap.get(e); if (t) for (let n of t) n.removeAttribute("loading") } for (const img of document.getElementsByTagName("img")) if (img.hasAttribute("loading")) { var e = imageNamesMap.get(img.src); if (e) e.push(img); else { imageNamesMap.set(img.src, [img]); let t = document.createElement("div"); t.innerHTML = `<link rel="prefetch" as="image" href="${img.src}" onload="removeLazyLoading('${img.src}')">`, document.head.appendChild(t.firstChild) } } function burgerButtonClicked() { var e = document.getElementById("nav"), t = document.getElementById("header"), n = document.getElementById("burger-menu-icon"); e.classList.toggle("active"), n.classList.toggle("active"), e.classList.contains("active") ? (t.classList.add("active"), document.addEventListener("click", navClickSomewhere)) : (t.classList.remove("active"), document.removeEventListener("click", navClickSomewhere)) } function navClickSomewhere(e) { header.contains(e.target) || burgerButtonClicked() } let withRest, canvas, svg, svgns = "http://www.w3.org/2000/svg"; const svgContainer = document.getElementById("svg-container"), exerciseContainer = document.getElementById("exercise-container"), saveCalculationAccordion = document.getElementById("save-calculation-accordion"), input_number1 = document.getElementById("number1"), input_number2 = document.getElementById("number2"), calcYourselfCheckbox = document.getElementById("calculate-yourself-checkbox"), message = document.getElementById("message"), messageContainer = document.getElementById("message-container"); input_number1.addEventListener("input", () => { input_number1.setCustomValidity("") }), input_number2.addEventListener("input", () => { input_number2.setCustomValidity("") }), input_number1.addEventListener("keyup", e => { "Enter" == e.key && (calcYourselfCheckbox.checked ? calculate(mult_self, "multiplizieren") : calculate(mult, "multiplizieren")) }), input_number2.addEventListener("keyup", e => { "Enter" == e.key && (calcYourselfCheckbox.checked ? calculate(mult_self, "multiplizieren") : calculate(mult, "multiplizieren")) }), document.getElementById("input-filename").addEventListener("keyup", e => { "Enter" == e.key && downloadImage("Multiplikation") }), window.addEventListener("keydown", e => { "Insert" == e.key && downloadSVG("multi.svg") }), loadParameters();